DROP SCHEMA IF EXISTS chat CASCADE;
CREATE SCHEMA IF NOT EXISTS chat;

CREATE TABLE IF NOT EXISTS chat.user
(
    user_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    login TEXT UNIQUE NOT NULL,
    password TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS chat.chatroom
(
    chatroom_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name TEXT NOT NULL,
    user_id BIGINT NOT NULL REFERENCES chat.user(user_id)
);

CREATE TABLE IF NOT EXISTS chat.message
(
    message_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id BIGINT NOT NULL REFERENCES chat.user(user_id),
    chatroom_id BIGINT NOT NULL REFERENCES chat.chatroom(chatroom_id) ON DELETE CASCADE,
    text TEXT NOT NULL,
    date_time TIMESTAMP(6)
)
